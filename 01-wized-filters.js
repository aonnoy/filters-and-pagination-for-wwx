window.Wized=window.Wized||[];window.Wized.push((Wized)=>{let e;let t=getCurrentFilterState();function getCurrentFilterState(){const e={};const t=document.querySelectorAll("[wized-variable]");t.forEach((t)=>{const n=t.getAttribute("wized-variable");e[n]=Wized.data.v[n]});return e}function haveFiltersChanged(){const e=getCurrentFilterState();return JSON.stringify(e)!==JSON.stringify(t)}window.executeWizedRequest=async()=>{if(haveFiltersChanged()){const e=document.querySelector('[wized-filter-element="filters"]');if(e&&e.hasAttribute("wized-filter-request")){const t=e.getAttribute("wized-filter-request");try{await Wized.requests.execute(t);console.log(`Request ${t} executed successfully`);t=getCurrentFilterState()}catch(e){console.error(`Error executing request ${t}:`,e)}}}};const n=(e,t)=>{return(...n)=>{clearTimeout(e);e=setTimeout(()=>t.apply(this,n),t)}};const r=(e,t)=>{Wized.data.v[e]=t};const i=()=>{const e=document.querySelector('[wized-filter-element="filters"]')?.getAttribute("wized-filter-current-page");if(e&&Wized.data.v.hasOwnProperty(e)){Wized.data.v[e]=1;window.executeWizedRequest()}};const a=n(()=>{if(haveFiltersChanged()){i();t=getCurrentFilterState()}},500);const o=(e)=>{const t=e.closest("[wized-variable]").getAttribute("wized-variable");const n=document.querySelectorAll(`[wized-variable="${t}"] input[type="checkbox"]`);const r=Array.from(n).filter((e)=>e.checked).map((e)=>e.nextElementSibling.textContent.trim());updateWizedVariable(t,r);a()};const c=(e)=>{const t=e.closest("[wized-variable]").getAttribute("wized-variable");const n=e.checked?e.nextElementSibling.textContent.trim():"";updateWizedVariable(t,n);a()};const s=(e)=>{const t=e.getAttribute("wized-variable");const n=e.value;updateWizedVariable(t,n);a()};const u=async()=>{const e=document.querySelector("[wized-filter-request-trigger]");if(e){const t=e.getAttribute("wized-filter-request-trigger");if(t){resetCurrentPageVariable();try{await Wized.requests.execute(t);console.log(`Triggered request ${t} executed successfully`)}catch(e){console.error(`Error executing triggered request ${t}:`,e)}}}};const l=()=>{const e=document.querySelector('[wized-filter-element="filters"]')?.getAttribute("wized-filter-current-page");if(e&&Wized.data.v.hasOwnProperty(e)){Wized.data.v[e]=1}};const f=()=>{const e=document.querySelectorAll("form");e.forEach((e)=>{e.addEventListener("submit",(e)=>{e.preventDefault();u()})})};const d=(e)=>{if(e.key==="Enter"){e.preventDefault()}};const h=(e)=>{e.preventDefault()};const p=()=>{document.querySelectorAll('[wized-variable] input[type="checkbox"]').forEach((e)=>{e.addEventListener("change",()=>o(e))});document.querySelectorAll('[wized-variable] input[type="radio"]').forEach((e)=>{e.addEventListener("change",()=>c(e))});document.querySelectorAll("select[wized-variable]").forEach((e)=>{e.addEventListener("change",()=>s(e))});f();const e=document.querySelector("input[wized-filter-search-variable]");if(e){e.addEventListener("keypress",d)}const t=document.querySelectorAll('form button, form a, form input[type="button"], form input[type="submit"]');t.forEach((e)=>{e.addEventListener("click",h)})};const g=()=>{const e=document.querySelector("[wized-filter-request-trigger]");if(e){e.addEventListener("click",u)}};const m=()=>{p();g()};const v=new MutationObserver((e)=>{e.forEach((e)=>{if(e.type==="childList"&&e.addedNodes.length>0){m()}})});v.observe(document.querySelector('[wized-filter-element="filters"]'),{childList:true,subtree:true});m()});
