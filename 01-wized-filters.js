window.Wized=window.Wized||[];window.Wized.push((Wized)=>{let e,n=getCurrentFilterState();function getCurrentFilterState(){const e={};document.querySelectorAll("[wized-variable]").forEach(n=>{const t=n.getAttribute("wized-variable");e[t]=Wized.data.v[t]});return e}function haveFiltersChanged(){const e=getCurrentFilterState();return JSON.stringify(e)!==JSON.stringify(n)}window.executeWizedRequest=async()=>{if(haveFiltersChanged()){const e=document.querySelector('[wized-filter-element="filters"]');if(e&&e.hasAttribute("wized-filter-request")){const n=e.getAttribute("wized-filter-request");try{await Wized.requests.execute(n),console.log(`Request ${n} executed successfully`),n=getCurrentFilterState()}catch(e){console.error(`Error executing request ${n}:`,e)}}}};const t=(t,n)=>{return(...s)=>{clearTimeout(e),e=setTimeout(()=>t.apply(this,s),n)}};const r=(t,n)=>{Wized.data.v[t]=n};const o=()=>{const e=document.querySelector('[wized-filter-element="filters"]')?.getAttribute("wized-filter-current-page");e&&Wized.data.v.hasOwnProperty(e)&&(Wized.data.v[e]=1,window.executeWizedRequest())};const i=t(()=>{haveFiltersChanged()&&(o(),n=getCurrentFilterState())},500);const s=(e,t)=>{const n=e.closest("[wized-variable]").getAttribute("wized-variable"),r=document.querySelectorAll(`[wized-variable="${n}"] input[type="checkbox"]`),o=Array.from(r).filter(e=>e.checked).map(e=>e.nextElementSibling.textContent.trim());r(n,o),i()},c=(e,t)=>{const n=e.closest("[wized-variable]").getAttribute("wized-variable"),r=e.checked?e.nextElementSibling.textContent.trim():"";r(n,r),i()},a=(e,t)=>{const n=e.getAttribute("wized-variable"),r=e.value;r(n,r),i()};const l=async()=>{const e=document.querySelector("[wized-filter-request-trigger]");if(e){const n=e.getAttribute("wized-filter-request-trigger");n&&(resetCurrentPageVariable(),try{await Wized.requests.execute(n),console.log(`Triggered request ${n} executed successfully`)}catch(e){console.error(`Error executing triggered request ${n}:`,e)}}};const u=()=>{const e=document.querySelectorAll("form");e.forEach(e=>{e.addEventListener("submit",e=>{e.preventDefault(),l()})})};const d=e=>{if("Enter"===e.key){e.preventDefault()}};const f=e=>{e.preventDefault()};const h=()=>{document.querySelectorAll('[wized-variable] input[type="checkbox"]').forEach(e=>{e.addEventListener("change",()=>s(e))}),document.querySelectorAll('[wized-variable] input[type="radio"]').forEach(e=>{e.addEventListener("change",()=>c(e))}),document.querySelectorAll("select[wized-variable]").forEach(e=>{e.addEventListener("change",()=>a(e))}),u();const n=document.querySelector("input[wized-filter-search-variable]");n&&n.addEventListener("keypress",d),document.querySelectorAll('form button, form a, form input[type="button"], form input[type="submit"]').forEach(e=>{e.addEventListener("click",f)})};const g=()=>{const e=document.querySelector("[wized-filter-request-trigger]");e&&e.addEventListener("click",l)};const p=()=>{attachListeners(),attachTriggerListener()};const m=new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&e.addedNodes.length>0&&p()})});m.observe(document.querySelector('[wized-filter-element="filters"]'),{childList:!0,subtree:!0}),p()});

